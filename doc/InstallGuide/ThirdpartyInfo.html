<!--
  The contents of this file are subject to the University of Utah Public
  License (the "License"); you may not use this file except in compliance
  with the License.
  
  Software distributed under the License is distributed on an "AS IS"
  basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  License for the specific language governing rights and limitations under
  the License.
  
  The Original Source Code is SCIRun, released March 12, 2001.
  
  The Original Source Code was developed by the University of Utah.
  Portions created by UNIVERSITY are Copyright (C) 2001, 1994 
  University of Utah. All Rights Reserved.
-->

<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <meta name="Author" content="Erik Jorgensen">
 <link rel=stylesheet type="text/css" href="../doc_styles.css">
 <title>SCIRun inst and build instructions - Unix version</title>
</head>

<body>
<!-- *************************************************************** -->
<!-- *************** STANDARD SCI RESEARCH HEADER ****************** -->
<!-- *************************************************************** -->
<center><img SRC="../images/research_menuheader.gif" usemap="#head-links" height="71" width="600" border="0"></center>
<map name="head-links">
	<area shape="rect" coords="491,15,567,32" href="http://www.sci.utah.edu/research/research.html">
	<area shape="rect" coords="31,9,95,36" href="http://www.sci.utah.edu">
	<area href="../InstallGuide/pseInstall.html" coords="0,45,150,70">
	<area href="../UserGuide/userguide.html" coords="150,45,300,70">
	<area href="../DeveloperGuide/devguide.html" coords="300,45,450,70">
	<area href="../ReferenceGuide/refguide.html" coords="450,45,600,70">
</map>
<!-- *************************************************************** -->
<!-- *************************************************************** -->

<p class="title">Thirdparty Software Installation and Build Information</p>
<p class="subtitle">(Unix version - April 3, 2001)</p>

<p class="head">Table of contents</p>
<ol class="toc">
      <LI><A HREF="#Prerequisites">Prerequisites</A></LI>
      <LI><A HREF="#Auto">Automatic Installation of All Thirdparty Software</A>
      <LI><A HREF="#Manual">Manual Installation of Required Thirdparty Software
</A>
      <LI><A HREF="#Gotchas">Known Issues</A></LI>
</ol>

<p class="head"><a name="Prerequisites">Prerequisites</a></p>
    <p class="firstpara">
      Use of this document requires experience with the SGI
      Irix operating system and/or the Linux operating system.
      Knowledge of file systems, programming in C/C++, building
      software from tarball distributions and shell scripting will
      be useful if not required.  The installation or upgrade of
      core system components (such as the OS and compilers) may be
      required.  As such, a system administrator's assistance may
      be warranted.
    </p>

    <p class="firstpara">
      The following information may help expedite the process of
      installing the required third party software.  However, It is not
      intended to replace the installation instructions, provided with
      the software, only to supplement them.  Please read the
      build instructions for each software distribution before attempting to
      use these instructions.
    </p>

    <p class="firstpara">
      This information does not apply to the installation and upgrade of
      the OS and build tools, as those topics are quite involved.
    </p>

<p class="head"><a name="Auto">Automatic Installation of All Thirdparty
    Software</a></p>
    <p class="firstpara">
      Because of many bugs and gotchas in the thirdparty installation
      processes, the easiest and most dependable way to install the
      third party software is by using the thirdparty install script created
      by the SCI Institute.
    </p>

    <p class="firstpara">
      However, if you want or need to install the third party software by
      hand, you can continue by following the instructions on this page
      starting at <a href="#Manual">Manual Installation of Required Thirdparty
      Software</a>.
    </p>

    <p class="firstpara">
      The automatic install script comes with all the necessary thirdparty
      software, and does not require you to download anything else.
    </p>
    
    <p class="firstpara">
      To use the automatic install script do the following:
    </p>

    <p class="firstpara">
      <b>1.  Download the install script tar ball from
      <a href="http://ampano.cs.utah.edu/research/software/bundles/Thirdparty_install.tar.gz">
      here</a>.</b>
    </p>

    <p class="firstpara">
      <b>2.  Put the tar ball into a directory of your choosing.</b>
    </p>

    <p class="firstpara">
      <b>3.  Unzip and untar the tar ball:</b>
    </p>

    <pre class="example"><font color=blue>gunzip Thirdparty_install.tar.gz
tar xvf Thirdparty_install.tar</font></pre>

    <p class="firstpara">
      <b>4.  Run the install script by typing:</b>
    </p>

    <pre class="example"><font color=blue>python install 32</font></pre>

    <p class="firstpara">
      For 32 bit binaries and libraries, or
    </p>

    <pre class="example"><font color=blue>python install 64</font></pre>

    <p class="firstpara">
      for 64 bit binaries and libraries.  64 bit is available for SGI only.
    </p>

    <p class="firstpara">
      you can also specify a faster parallel build by giving an 
      integer which provides the "number of jobs" argument for GNU make
      For example, to build 32 bit binaries and libraries using 12 jobs,
      type the following:
    </p>

    <pre class="example"><font color=blue>python install 32 12</font></pre>

    <p class="firstpara">
      The install script will create a directory named SCIRun_Thirdparty_32 
      in the directory chosen in step 2 above.  When it finishes, it will
      display a message regarding the --with-thirdparty SCIRun configure 
      option.  Cut and paste that option when running the configure command
      for SCIRun (see step 2 of <a href="pseInstall.html#Building">Building
      SCIRun</a>).
    </p>

    <p class="firstpara">
      The install script requires Python version 1.5 or greater
    </p>
      
<p class="head"><a name="Manual">Manual Installation of Required Thirdparty
    Software</a>
</p>

<p class="subhead"><a name="Buildtools">Recommended Tools For Building Thirdparty Software</a></p>

    <p class="firstpara">
      You should use the same build tools to build the third party software as
      is required for building SCIRun itself.
    </p>

<p class="subhead"><a name="Install">Recommended Installation Location of Third Party 
    Software</a></p>
    <p class="firstpara">
      SCIRun uses the latest versions of all the software that it requires, and
      can be configured to use those versions regardless of where that 
      software is installed, whether
      it is all installed in the same location or not.  However, if the target
      install machine requires older versions of the same software (for other
      programs) then it is recommended that all the required third
      party software be installed into a centralized and out-of-the-way
      directory rather than in a directory already occupied by older versions
      of the third party software.
    </p>

    <p class="firstpara">
      That said, if the target install machine only needs the latest versions
      of software, or if it doesn't matter one way or the other, then it is
      perfectly safe to install the required thirdparty software into any
      directory including directories where older versions are already 
      installed.
    </p>

    <p class="firstpara">
      An example of a centralized and out-of-the-way location would be:
      <b>/usr/local/SCIRun_Thirdparty_32</b> such that after installation
      the contents of that directory would look like this (assuming that
      the tarballs were unzipped and untarred in the /src directory inside
      /usr/local/SCIRun_Thirdparty_32):
    </p>

    <pre class="example">/usr/local/SCIRun_Thirdparty_32/bin
/usr/local/SCIRun_Thirdparty_32/include
/usr/local/SCIRun_Thirdparty_32/lib
/usr/local/SCIRun_Thirdparty_32/man
/usr/local/SCIRun_Thirdparty_32/src/blt2.4u
/usr/local/SCIRun_Thirdparty_32/src/itcl3.1.0
/usr/local/SCIRun_Thirdparty_32/src/tcl8.3.2
/usr/local/SCIRun_Thirdparty_32/src/tk8.3.2
/usr/local/SCIRun_Thirdparty_32/src/xerces-c-src1_4_0
    </pre>

<p class="subhead"><a name="Configure"> Recommended Configure Options for Third Party Software</a></p>

    <p class="firstpara">
      <b><i>NOTE</b></i>: <i><b><font color=green>INST_DIR</font></b></i> 
      represents
      the chosen installation directory for the indicated software
      distribution.  <i><b><font color=green>INST_DIR</font></b></i>
      would be "/usr/local/SCIRun_Thirdparty_32" for the example given
      above.  Note that the <i><b><font color=green>INST_DIR</font></b></i>
      does not have to be the same for each distribution, but can be if it
      is desired as is demonstrated in the example.
    </p>

    <p class="firstpara">
      <b>For Tcl, Tk and [incr Tcl/Tk]</b>
    </p>

    <pre class="example"><font color=blue>configure --prefix=</font><i><b><font
	  color=green>INST_DIR</font></b></i>
    </pre>

    <p class="firstpara">
      <b>For BLT</b>
    </p>

    <pre class="example"><font color=blue>configure --with-cc=cc --prefix=</font><i><b><font color=green>INST_DIR</font></b></i>
    </pre>

    <p class="firstpara">
      <b>For Xerces-C</b>
    </p>

    <p class="firstpara">
      First, set the indicated environment variables listed below, then type:
    </p>

    <pre class="example"><font color=blue>configure --prefix=</font><i><b><font color=green>INST_DIR</font></b></i>
    </pre>

    <p class="firstpara">
      On SGI machines:
    </p>

    <pre class="example"><font color=blue>XERCESCROOT = <font color=green><b><i>XERCES_C_ROOT</i></b></font>
TRANSCODER = NATIVE
MESSAGELOADER = INMEM
NETACCESSOR = FileOnly
CC = cc
CXX = CC 
LDFLAGS = " -n32 "
LIBS = " -n32 "
CXXFLAGS = "-O -DXML_USE_NATIVE_TRANSCODER -DXML_USE_INMEM_MESSAGELOADER -n32 -DAPP_NO_THREADS"
CFLAGS = "-O -DXML_USE_NATIVE_TRANSCODER -DXML_USE_INMEM_MESSAGELOADER -n32 -DAPP_NO_THREADS"</font>
    </pre>

    <p class="firstpara">
      On Linux machines:
    </p>

    <pre class="example"><font color=blue>XERCESCROOT = <font color=green><b><i>XERCES_C_ROOT</i></b></font>
TRANSCODER = NATIVE
MESSAGELOADER = INMEM
NETACCESSOR = FileOnly
CC = gcc
CXX = g++ 
LIBS = " -lpthread "
CXXFLAGS = "-O -DXML_USE_NATIVE_TRANSCODER -DXML_USE_INMEM_MESSAGELOADER"
CFLAGS = "-O -DXML_USE_NATIVE_TRANSCODER -DXML_USE_INMEM_MESSAGELOADER"
      </font>
    </pre>

    <p class="firstpara">
      Where <font color=green><b><i>XERCES_C_ROOT</i></b></font> is the root
      of the unzipped and untarred xerces 1.4.0 distribution.  For the example
      given above, <font color=green><b><i>XERCES_C_ROOT</i></b></font> would
      be "/usr/local/SCIRun_Thirdparty_32/src/xerces-c-src1_4_0".
    </p>

<p class="head"><a name="Gotchas">Known Issues For Manual Builds</a></p>
    <p class="firstpara">
      This section describes known issues with installing and building the
      required third party software.  It also includes solutions when
      available. 
    </p>

<p class="subhead">Path Specifications</p>
    <p class="firstpara">
     If any of the software, SCIRun or thirdparty, is installed into a user's
     home directory, <i><b>do not</b></i> use abbreviations such as tilde
     expansion when specifying paths.  Instead, use full absolute paths.
     For example, use /home/bob/SCIRun instead of ~bob/SCIRun for the 
     --prefix arguments when configuring.  Most abbreviation techniques will
     not get expanded by the build scripts for any of the software.
    </p>

<p class="subhead">Building with 64 bit enabled on SGI</p>
    <p class="firstpara">
      Unfortunately, most of the required third party software didn't have
      64 bit SGI platforms in mind when they wrote their configure scripts
      and makefiles.  However, it is possible to build all the software in
      64 bit with some effort.  In general, to get 64 bit versions of the
      third party software it is necessary to edit Makefiles such that
      the CFLAGS and LFLAGS macros have "-64" listed instead of "-n32".
      In the case of the tcl distributions, this means editing the
      makefiles (after configuring) by hand and replacing all instances of 
      "-n32" with "-64".  For Xerces, this means changing the environment
      variables listed above replacing all instances of  " -n32 " with " -64 ".
    </p>

<p class="subhead">Building [incr Tcl/Tk]</p>
    <p class="firstpara">
      The [incr Tcl/Tk] distribution listed in the system requirements has a
      bug in it:  The installation scripts are bundled without execute
      permissions.  Before attempting to configure or make [incr Tcl/Tk],
      type the following commands:
    </p>

    <pre class="example"><font color=blue>cd itcl3.1.0/config
chmod a+x install-sh mkinstalldirs</font></pre>

    <p class="firstpara">
      Then, proceed normally with the configure and make.
    </p>

<p class="subhead">Building BLT</p>
    <p class="firstpara">
      The BLT make files have bugs in them that cause apparent errors in the
      building process.  To build without the apparent errors, type the
      following (in the order shown!) after configuring:
    </p>

    <pre class="example"><font color=blue>cd blt2.4u
make 
cd src/shared
make 
cd ../..
make -k install
cd src/shared
make -k install</font>
    </pre>

<p class="subhead">Building Xerces-c</p>
    <p class="firstpara">
      The make system for Xerces-c is not standard and has many bugs.  The
      following all apply after configuring xerces.
    </p>

    <p class="firstpara">
      The configure scripts are bundled without execute permissions.  Before
      attempting to configure, type the following commands:
    </p>

    <pre class="example"><font color=blue>cd xerces-c-src1_4_0/src
chmod a+x configure runConfigure</font></pre>

    <p class="firstpara">
      There is no dependancy tree for the copy phase of the xerces build,
      so using a -j flag (number of jobs) as a GNU make argument will cause
      the build to fail.
    </p>

    <p class="firstpara">
      There is no dependancy tree for the "install" target within the make
      files, so passing "install" as an argument to the first time "make" is
      typed will cause the build to fail.  Instead type "make" first, then
      "make install".
    </p>

    <p class="firstpara">
      The make system ignores errors in compilation and forces a link.  Verify
      that the build was actually successful by checking the size of 
      libxerces-c1_4.so.  The sizes should be: ~2.1MB for SGI 32 bit, ~2.4MB
      for SGI 64 bit, and ~1.4MB for linux.
    </p>


<!-- ******************************************************************* -->
<!-- *********************** STANDARD SCI FOOTER *********************** -->
<!-- ******************************************************************* -->
<center>
<hr size="1" width="600">
<font size="-1"><a href="http://www.sci.utah.edu">Scientific Computing and Imaging Institute</a> &#149; <a href="http://www.utah.edu">University of Utah</a> &#149; 
(801) 585-1867</font>
</center>
<!-- ********************* END STANDARD SCI FOOTER ********************* -->
<!-- ******************************************************************* -->
</body>
</html>

\section{Installing Uintah} \label{Sec:installation}

The Uintah library is composed of several executables and a generic
library framework for solving PDEs on structured AMR grids.  The VisIT
and Teem libraries are used to visualize the resulting data.

Uintah can be obtained either from a tarball \tt
http://www.uintah.utah.edu \normalfont or by using svn to download the
latest source from the following:

\begin{Verbatim}[fontsize=\footnotesize]
  svn co https://code.sci.utah.edu/svn/SCIRun/trunk Uintah
\end{Verbatim}

The above command checks out the Uintah source tree and installs it
into a directory called Uintah in the users home directory.

VisIT can be obtained from https://wci.llnl.gov/codes/visit/. And Teem
can be obtained from http://teem.sourceforge.net/.


\subsection{Library Dependencies}

Uintah depends on several different libraries that are commonly
available or easily installable on various Linux or Unix like OS
distributions.  

Required libraries:

mpi (openmpi, mpich, or lam or a vendor supplied mpi library)
blas
lapack
make
libxml2-devel
zlib-devel
c++
subversion
ccmake

Useful libraries:
hypre-2.0
petsc 2.3.3

Hypre 2.0 can be downloaded from
https://computation.llnl.gov/casc/hypre/software.html.

Petsc 2.3.3 can be downloaded from
http://www.mcs.anl.gov/petsc/petsc-as/download/index.html.


\subsection{Debian Dependencies}

The Debian OS offers the vast majority of libraries necessary for
installing Uintah with the exception of VisIT and Teem.

Installing the following libraries will ensure that all dependencies
required for Uintah are satisfied: subversion libhypre-dev petsc-dev
libxml2-dev zlib1g-dev liblapack-dev cmake cmake-curses-gui.

Once these libraries are installed, Teem and VisIT can be installed
followed by installation of Uintah.

\subsection{Fedora Core 9 Dependencies}

Fedora Core 9 offers all the dependencies except for petsc and hypre.
Installation of the following libraries: openmpi-devel openmpi-libs
lapack-devel gcc-gfortran blas-devel gcc-c++ libxml2-devel subversion
make tar diffutils.

\subsection{CentOS 5 Dependencies}

CentOS 5 does not provide an openmpi rpm, however a src.rpm can be
downloaded from http://www.open-mpi.org:80/software/ompi/v1.3/ and
installed via rpmbuild

\begin{Verbatim}
rpmbuild --rebuild --define 'dist .centos5' openmpi-1.3.1-1.src.rpm
rpm -i openmpi-1.3.1-1.*.rpm
\end{Verbatim}

The location of the rpm is likely to be found in
/usr/src/redhat/RPMS/ARCH where ARCH is either i386 or x86\_64.

Once mpi has been built, the other libraries can be installed:
lapack-devel gcc-gfortran blas-devel gcc-c++ libxml2-devel subversion
make tar diffutils.

\subsection{MPI issues}

The openmpi library that is installed with Fedora Core 9 needs to have
a 'helper' directory set up with symbolic links assigned so that
Uintah can find the location of specific include files and shared
libraries.

Execute the following as root:

\begin{Verbatim}

mkdir /usr/local/openmpi
cd /usr/local/openmpi
ln -s /usr/include/openmpi/1.2.4-gcc include
ln -s /usr/lib64/openmpi/1.2.4-gcc lib

\end{Verbatim}



\subsection{Petsc Installation}

Petsc can be installed by executing the following simplified
instructions.  Please refer to the petsc website for comprehensive
installation instructions if you encounter any difficulties.

Download petsc-2.3.3 from
http://www.mcs.anl.gov/petsc/petsc-as/download/index.html

The following configure script assumes the location of mpi is in
/usr/local/openmpi using the Fedora Core 9 OS.  For other OS
distributions, the location of the mpi libraries may be found
automatically.

\begin{Verbatim}
  
tar zxf petsc-2.3.3.tar.gz
cd petsc-2.3.3-p15

./config/configure.py --with-shared --with-debugging=0 --with-mpi-dir=/usr/local/openmpi/ --prefix=/usr/local/petsc

make all

make install

\end{Verbatim}

\subsection{Hypre Installation}

Hypre can be installed by executing the following simplified
instructions, however, if you encounter problems please refer to the
hypre website for troubleshooting.

Download hypre-2.0 from
https://computation.llnl.gov/casc/hypre/download/hypre-2.0.0\_reg.html

If installing hypre on a 64bit platform, hypre must be modified to add
the -fPIC compile option.  After unpacking the hypre tar file, edit
the Makefile in hypre-2.0.0/src/lapack and add the -fPIC to line 128.
It should look like the following:

\begin{verbatim}

${CC} -c -fPIC dlamch.c

\end{verbatim}

Depending on the location of the mpi libraries, i.e. location of mpi.h
and libmpi.so, the configure line for hypre should look something like this:

\begin{Verbatim}

cd hypre-2.0.0/src

./configure --enable-shared
--with-MPI-include=/usr/local/openmpi/include/
--with-MPI-lib-dirs=/usr/local/openmpi/lib/ --with-MPI-libs="mpi pmpi
util" --prefix=/usr/local/ CFLAGS=-DMPIPP_H CXXFLAGS=-DMPIPP_H

make

make install

\end{Verbatim}

 

\subsection{Teem Installation}

Download Teem from http://teem.sourceforge.net/download/index.html.  Teem uses cmake to configure the build system. Installation instructions for Teem are found at http://teem.sourceforge.net/build.html.  Simplified instructions are as follows:

\begin{verbatim}

tar zxf teem-1.10.0-src.tar.gz

cd teem-1.10.0-src/

mkdir teem-build

cd teem-build

ccmake ../

Teem and VisIT need to be installed first before Uintah can be configured.

Use the arrow keys to scroll down to the fourth line 'BUILD_SHARED_LIBS' and press the 
return key to toggle the 'ON' flag.

Press the 'c' key

Press the 'g' key

make

make install

\end{verbatim}

The Teem libraries and include files will be install in /usr/local hierarchy.


\subsection{VisIT Installation}
VisIT has a build script which builds VisIT plus all of its dependencies.

The build script can be downloaded from
https://wci.llnl.gov/codes/visit/1.11.2/build\_visit

Make the build\_script executable:

\begin{verbatim}

chmod +x build\_script

\end{verbatim}

Create a directory for VisIT and launch the build\_script using four
processors (-j4):

\begin{verbatim}

mkdir Visit

cp build\_script Visit

cd Visit

./build\_script --makeflags '-j4'

\end{verbatim}

The build\_visit script will launch a GUI.  Use the space key to
unselect the Optional and then scroll down to the Parallel option and
select that.  The GUI will determine the location of the mpi libraries
and then start the build process.  All source files will be downloaded
and installed in the ~/Visit/visit1.11.2 directory.  The \tt visit
\normalfont executable is found in ~/Visit/visit1.11.2/src/bin .

\subsubsection{Configuring Uintah}

cd to \tt ~/Uintah \normalfont and create the following directories:
dbg and opt

\begin{verbatim}

mkdir dbg opt

\end{verbatim}

Go to the dbg directory and enter the following:

\begin{Verbatim}[fontsize=\footnotesize]
../src/configure --enable-debug --with-teem=/usr/local
--with-visit=/home/user_name/Visit/visit1.11.2
\end{Verbatim}

If building on a 64bit platform, append \tt --enable-64bit \normalfont
to the configure line.

After the configuration process, type \tt make \normalfont to compile
Uintah.

Once a debug build has finished, change to the opt directory and enter
the following configure line:

\begin{Verbatim}[fontsize=\footnotesize]
./src/configure --enable-optimze --enable-assertion-level=0 
--with-teem=/usr/local
--with-visit=/home/user_name/Visit/visit1.11.2
\end{Verbatim}

Then build the software by typing \tt make \normalfont at the command line.

\subsection{Installing Visualization Software}

Visualization of Uintah data is currently possible using any of three
software packages.  These are SCIRun, VisIt and Manta.  Of these, SCIRun is
no longer supported, although legacy versions will continue to work.  The
VisIt package from LLNL is general purpose visualization software that offers
all of the usual capabilities for rendering scientific data.  It is still
developed and maintained by LLNL staff, and its interface to Uintah data is
supported by the Uintah team.  Manta offers volume rendering and particle
visualizaton based on parallel (shared memory) ray tracing techniques.
While the capabilities of Manta are more limited, it is a fast way to
interactively interrogate reasonably large datasets, provided the user has
access to a reasonable shared memory resource, (e.g. an 8 core desktop system).

\subsection{Installing Manta}

For complete build instructions for Manta, please refer to
http://software.sci.utah.edu/manta/index.php/Trunk.  An abbreviated
installation guide is as follows:

Download the source via svn:

\begin{Verbatim}

svn co https://code.sci.utah.edu/svn/Manta/trunk Manta

\end{Verbatim}

Then create a build directory within Manta/

\begin{Verbatim}

mkdir Manta/build-manta

cd Manta/build-manta

\end{Verbatim}

From  within Manta/build-manta,  configure the  build using  cmake and
then run  make itself on the  source.

\begin{Verbatim}

cmake ..

make


\end{Verbatim}

The manta executable is located in Manta/build-manta/bin.


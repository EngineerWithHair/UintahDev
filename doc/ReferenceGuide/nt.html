<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Erik Jorgensen">
   <link rel=stylesheet type="text/css" href="http://www.sci.utah.edu/scirun_docs/doc/doc_styles.css">
   <title>Things You Need To Know About How To Build the PSE for NT (in house only)</title>
</head>
<body>
<a href="http://www.sci.utah.edu"><img style="margin-left:-2em" src="/images/SCI_logo.gif" border="0" height="66" hspace=10 width="150"></a>

<p class="title">Things You Need To Know About<br>
How To Build the PSE for NT </p>
<p class="subtitle">(in house only)</p>

<p class="head">Table of contents</p>

<ol type="1" class="toc">
<li> <a href="#a">Configuring your environment</a>
	<ol type="1" class="subtoc">
	<li> <a href="#aa">Putting stuff in your PATH</a>
	<li> <a href="#ab">Getting ssh access to csf</a>
	<li> <a href="#ac">Setting up CVS</a>
	<li> <a href="#ad">Setting up Tcl/Tk (and related stuff)</a>
	</ol><br>

<li> <a href="#b">Checking out and Building PSE</a>
	<ol type="1" class="subtoc">
	<li> <a href="#ba">Log into a build machine</a>
	<li> <a href="#bb">Checking out the PSE sources with CVS</a>
	<li> <a href="#bc">Configure the build for your system setup</a>
	<li> <a href="#bd">Build the sources</a>
	</ol><br>

<li> <a href="#c">Starting the PSE</a>
</ol>


<p class="head"><a name="a">Configuring your environment</a></p>

<p class="para">Before you can build PSE for NT, you must meet certain system requirements.</p>

<p class="para">First, you need to have the following third party software packages installed on the the machine you intend to build on:</p>

<blockquote>
Microsoft Visual C++ version 6.0 (or higher)<br>
Tcl/Tk version 8.0.4 (or 8.0.5)<br>
Itcl/Itk version 3.0.1<br>
ONCRPC (by Martin Gergeleit)<br>
zlib  version 1.1.3
</blockquote>

<p class="para">If you want to access the development repository you also need to have these:</p>

<blockquote>
Cyclic software CVS version 1.10<br>
ssh (a secure shell login program)
</blockquote>

<p class="para">All of these packages are available in the PSE\3rdParty directory, if you don't already have them.</p>

<p class="para">Second, you need to appropriately configure your environment by making changes to your startup  environment variables (My Computer - Properties - Environment). The changes needed are described in the following sections.</p>

<p class="subhead"><a name="aa">Putting stuff in your PATH</a></p>

<p class="para">You should edit your PATH environment variable to include the following:</p>

<pre class="example">
c:\progra~1\micros~1\vc98 (the path to your Visual C++ directory)
c:\progra~1\micros~1\vc98\bin (the path to your vc++ executables)
c:\progra~1\micros~1\vc98\lib (the path to yoru vc++ libraries)
c:\progra~1\micros~1\common\msdev98\bin (the path to your msdev executables)
c:\progra~1\tcl\install\lib (the path to your Tcl/Tk, and related, dll libraries)
c:\progra~1\oncrpc\lib (the path to your oncrpc dll library)
c:\progra~1\zlib\lib (the path to your zlib dll library)
c:\progra~1\cyclic~1\cvs (the path to your cvs executables)
c:\progra~1\ssh (the path to your ssh executables)
</pre>

<p class="para">The paths shown above are just example paths.  You need to substitute the paths that match your machine setup.</p>
  
<p class="subhead"><a name="ab">Getting ssh access to csf</a></p>

<p class="para">The PSE sources are kept on the C-SAFE server, csf.cs.utah.edu.  You must be able to ssh to this machine in order to aquire the sources.  Most people already have access to this machine.  At a prompt (in these examples, ">" is the prompt), type:</p>

<pre class="example">
> ssh csf
</pre>

<p class="para">You may be asked for your password, but should successfully be able to log into csf.  If not, go talk to Someone Who Fixes These Things and get it fixed.</p>

<p class="subhead"><a name="ac">Setting up CVS</a></p>

<p>The PSE source tree is managed by CVS. CVS uses the "ssh" command to access the source repository on csf.cs.utah.edu.</p>

<p>You need to have the following environment variables set:</p>

<pre class="example">
CVS_RSH = ssh
CVSROOT = csf.cs.utah.edu:/csafe_noexport/cvs/cvsroot
</pre>
 
<p class="subhead"><a name="ad">Setting up Tcl/Tk (and related stuff)</a></p>

<p>Set the following environment variables:</p>

<pre class="example">
TCL_LIBRARY=c:\progra~1\tcl\install\lib\tcl8.0.4
TK_LIBRARY=c:\progra~1\tcl\install\lib\tk8.0.4
ITCL_LIBRARY=c:\progra~1\tcl\install\lib\itcl3.0
ITK_LIBRARY=c:\progra~1\tcl\install\lib\itk3.0
PACKAGE_PATH=../PSECommon
</pre>

<p>Again, the paths shown above are just example paths.</p>

<p class="head"><a name="b">Checking out and Building PSE</a></p>

<p class="subhead"><a name="ba">Log into a build machine</a></p>

<p>Log into any NT box that meets the system requirements outlined in section 1.</p>

<p class="subhead"><a name="bb">Checking out the PSE sources with CVS</a></p>

<p class="para">The PSE sources are managed by the CVS version control system.  In a CMD shell go to whatever directory you want to work in and check out the sources:</p>

<pre class="example">
> cd myWorkingDirectory
> cvs -d :ext:%CVSROOT% PSE

[lots of files go by]
</pre>

<p class="subhead"><a name="bc">Configure the build for your system setup</a></p>

<p>Edit the following file:</p>

<p class="example">
PSE\src\scripts\Makefile.vc.config
</p>

<p>to look something like this:</p>

<pre class="example">
##########################  EDIT HERE  #########################

## set the command macros
CC            = cl
LINK          = link
MAKE          = nmake
RM            = del

## set VERSION to build debug or release versions of all binaries
## NOTE: "d" will be appended to the names of debug libraries (ala tcl/tk).
VERSION       = Release
#VERSION      = Debug

## set the warning level
#WARNING      = -W2
WARNING       = -W1

## the default paths to 3rd party libraries
LIBPATH       = -LIBPATH:c:\progra~1\oncrpc\lib\
				-LIBPATH:c:\progra~1\zlib\lib\
		        -LIBPATH:c:\progra~1\tcl\install\lib

## the default paths to 3rd party include files
INCPATH       = -Ic:\progra~1\oncrpc\
                -Ic:\progra~1\oncrpc\rpc\
                -Ic:\progra~1\zlib\include\
				-Ic:\progra~1\tcl\src\tcl8.0.5\generic\
				-Ic:\progra~1\tcl\src\tcl8.0.5\win\
				-Ic:\progra~1\tcl\src\tk8.0.5\generic\
				-Ic:\progra~1\tcl\src\tk8.0.5\win\
				-Ic:\progra~1\tcl\src\tk8.0.5\xlib\
				-Ic:\progra~1\tcl\src\itcl3.0.1\itcl\generic\
				-Ic:\progra~1\tcl\src\itcl3.0.1\itcl\win\
				-Ic:\progra~1\tcl\src\itcl3.0.1\itk\generic\
				-Ic:\progra~1\tcl\src\itcl3.0.1\itk\win\
				-Ic:\progra~1\tcl\src\blt2.4i\include\

################################################################
</pre>

<p class="subhead"><a name="bd">Build the sources</a></p>

<p class="para">You must build the sources with the 'nmake' command.  Other make's won't do. From the PSE\src directory:</p>

<pre class="example">
> nmake -fMakefile.vc
</pre>

<p class="head"><a name="c">Starting the PSE</a></p>

<p class="para">When finished building, you'll have a "pse" binary in PSE\src\main which you can run to start the PSE.  This binary has hard-coded paths to the locations of its components, including the PSE packages, the [i]Tcl/Tk libraries and files, and others.</p>

<pre class="example">
> cd PSE\src\main
> pse
</pre>

<center>
<hr>
<p><font size=-1><a href="http://www.sci.utah.edu">Scientific Computing and Imaging Institute</a> &#149; <a href="http://www.utah.edu">University of Utah</a> &#149; (801) 585-1867</font></p>
</center>

</body>
</html>


#include <config/sci.cf>

#ifdef SCI_QUARKS
#define TASK_IMPLEMENTATION_O  Task_Quarks.o
#define TASK_IMPLEMENTATION_CC Task_Quarks.cc
#else

#ifdef SCI_MACHINE_SGI
#define TASK_IMPLEMENTATION_O  Task_irix.o
#define TASK_IMPLEMENTATION_CC Task_irix.cc
LOCKS = lock.o

#if defined(SCI_IRIX6) && defined(SCI_64BIT)
ASOPT = -mips4
#else
ASOPT = -mips2
#endif

lock.o: lock_mips.s
	as -o lock.o lock_mips.s $(ASOPT)
#endif

#ifdef SCI_MACHINE_SOLARIS
#define TASK_IMPLEMENTATION_O  Task_solaris.o
#define TASK_IMPLEMENTATION_CC Task_solaris.cc
#endif

#ifdef SCI_MACHINE_Linux
#define TASK_IMPLEMENTATION_O Task_linux.o
#define TASK_IMPLEMENTATION_CC Task_linux.cc
#endif

#endif

#ifndef TASK_IMPLEMENTATION_O
#error "This machine does not have a Task library port..."
#endif
#ifndef TASK_IMPLEMENTATION_CC
#error "This machine does not have a Task library port..."
#endif

OBJS = ITC.o  Task.o  TASK_IMPLEMENTATION_O  $(LOCKS)
SRCS = ITC.cc Task.cc TASK_IMPLEMENTATION_CC

LIBNAME = Multitask

SO_LIBS =
SO_LDFLAGS = -L$(TOP)/lib -lMalloc SCI_CCLibs

SCIDependTarget($(SRCS))
SCIObjLibraryTarget($(LIBNAME),$(OBJS),$(SO_LIBS),$(SO_LDFLAGS))
